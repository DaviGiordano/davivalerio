---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => {
    const dateDiff = b.data.pubDate.valueOf() - a.data.pubDate.valueOf();
    if (dateDiff !== 0) return dateDiff;
    return b.data.order - a.data.order;
  });
---

<Base title="Blog — Davi Valerio" description="Blog posts by Davi Valerio">
  <!-- <h1>dgv-field-notes</h1> -->
  {
    posts.length === 0 ? (
      <p>No posts yet — check back soon.</p>
    ) : (
      <ul class="post-list">
        {posts.map((post) => (
          <li>
            <a href={`/blog/${post.id}/`}>
              <span class="post-title">{post.data.title}</span>
              <time datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toISOString().slice(0, 10)}
              </time>
            </a>
          </li>
        ))}
      </ul>
    )
  }
</Base>
