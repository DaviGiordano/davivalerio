---
import Base from '../layouts/Base.astro';
import { getCollection, render } from 'astro:content';

const projects = (await getCollection('research')).sort(
  (a, b) => a.data.sortOrder - b.data.sortOrder
);
---

<Base title="Research â€” Davi Valerio" description="Research projects by Davi Valerio">
  <h1>Research</h1>
  {
    projects.length === 0 ? (
      <p>No projects listed yet.</p>
    ) : (
      projects.map(async (project) => {
        const { Content } = await render(project);
        return (
          <section class="research-project">
            <h2>{project.data.title}</h2>
            <span class="status">{project.data.status}</span>
            <p>{project.data.description}</p>
            <Content />
            {project.data.links.length > 0 && (
              <ul class="research-links">
                {project.data.links.map((link) => (
                  <li>
                    <a href={link.url} target="_blank" rel="noopener noreferrer">
                      {link.label}
                    </a>
                  </li>
                ))}
              </ul>
            )}
          </section>
        );
      })
    )
  }
</Base>
